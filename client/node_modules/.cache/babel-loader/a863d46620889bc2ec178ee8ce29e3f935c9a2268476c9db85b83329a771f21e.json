{"ast":null,"code":"var _jsxFileName = \"/home/william/Documents/development/luckbrc/client/src/modules/Chat/Chat.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport \"./Chat.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Chat(_ref) {\n  _s();\n  let {\n    username,\n    userBtcAddress\n  } = _ref;\n  const [socket, setSocket] = useState(null);\n  const [message, setMessage] = useState(\"\");\n  const [chatLog, setChatLog] = useState([]);\n  useEffect(() => {\n    if (socket === null) {\n      setSocket(new WebSocket(\"ws://localhost:8080/ws\"));\n    }\n\n    // return () => {\n    //   if (!socket) return;\n    //   socket.close();\n    // };\n  }, [socket]);\n  useEffect(() => {\n    if (socket === null) return;\n    socket.addEventListener(\"message\", handleMessage);\n  }, [socket]);\n  function handleMessage(e) {\n    setChatLog(chatLog => [...chatLog, e.data]);\n  }\n  function isSocketOpen(ws) {\n    return ws.readyState === ws.OPEN;\n  }\n  function handleInputChange(e) {\n    setMessage(e.target.value);\n  }\n  function sendMessage(e) {\n    e.preventDefault();\n    if (message === \"\") return;\n    if (socket === null) return;\n    const currentTime = new Date();\n    if (!isSocketOpen(socket)) return;\n    try {\n      socket.send(`${currentTime.getHours().toString()}:${currentTime.getMinutes().toString()}:${currentTime.getSeconds().toString().length === 1 ? \"0\" + currentTime.getSeconds().toString() : currentTime.getSeconds().toString()}  ${userBtcAddress.substring(0, 3)}...: ${message}`);\n    } catch (err) {\n      console.log(err);\n      return;\n    }\n    setMessage(\"\");\n  }\n  switch (username) {\n    case \"\":\n      if (userBtcAddress === \"\") {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"Chat\",\n          children: \"Please connect your wallet!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 16\n        }, this);\n      }\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"Chat\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Please create a Username\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"chatInput\",\n            onChange: e => handleInputChange(e),\n            placeholder: \"Be Kind.\",\n            type: \"text\",\n            value: message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"sendButton\",\n            type: \"submit\",\n            onClick: e => sendMessage(e),\n            children: \"Send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this);\n    default:\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"Chat\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chatLog\",\n          children: chatLog.slice(0).reverse().map((item, index) => {\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"messageText\",\n              children: item\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"chatInput\",\n            onChange: e => handleInputChange(e),\n            placeholder: \"Be Kind.\",\n            type: \"text\",\n            value: message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"sendButton\",\n            type: \"submit\",\n            onClick: e => sendMessage(e),\n            children: \"Send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this);\n  }\n}\n_s(Chat, \"lBXRAKiVPf+WChMFx6LghTTXDRM=\");\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useEffect","useState","jsxDEV","_jsxDEV","Chat","_ref","_s","username","userBtcAddress","socket","setSocket","message","setMessage","chatLog","setChatLog","WebSocket","addEventListener","handleMessage","e","data","isSocketOpen","ws","readyState","OPEN","handleInputChange","target","value","sendMessage","preventDefault","currentTime","Date","send","getHours","toString","getMinutes","getSeconds","length","substring","err","console","log","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onChange","placeholder","type","onClick","slice","reverse","map","item","index","_c","$RefreshReg$"],"sources":["/home/william/Documents/development/luckbrc/client/src/modules/Chat/Chat.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport \"./Chat.css\";\n\ninterface ChatInterface {\n  userBtcAddress: string;\n  username: string;\n}\n\nexport default function Chat({ username, userBtcAddress }: ChatInterface) {\n  const [socket, setSocket] = useState<WebSocket | null>(null);\n  const [message, setMessage] = useState(\"\");\n  const [chatLog, setChatLog] = useState<Array<string>>([]);\n\n  useEffect(() => {\n    if (socket === null) {\n      setSocket(new WebSocket(\"ws://localhost:8080/ws\"));\n    }\n\n    // return () => {\n    //   if (!socket) return;\n    //   socket.close();\n    // };\n  }, [socket]);\n\n  useEffect(() => {\n    if (socket === null) return;\n    socket.addEventListener(\"message\", handleMessage);\n  }, [socket]);\n\n  function handleMessage(e: MessageEvent<any>) {\n    setChatLog((chatLog) => [...chatLog, e.data]);\n  }\n\n  function isSocketOpen(ws: WebSocket) {\n    return ws.readyState === ws.OPEN;\n  }\n\n  function handleInputChange(e: React.ChangeEvent<HTMLInputElement>) {\n    setMessage(e.target.value);\n  }\n\n  function sendMessage(e: React.MouseEvent<HTMLButtonElement, MouseEvent>) {\n    e.preventDefault();\n    if (message === \"\") return;\n    if (socket === null) return;\n    const currentTime = new Date();\n    if (!isSocketOpen(socket)) return;\n    try {\n      socket.send(\n        `${currentTime.getHours().toString()}:${currentTime\n          .getMinutes()\n          .toString()}:${\n          currentTime.getSeconds().toString().length === 1\n            ? \"0\" + currentTime.getSeconds().toString()\n            : currentTime.getSeconds().toString()\n        }  ${userBtcAddress.substring(0, 3)}...: ${message}`\n      );\n    } catch (err) {\n      console.log(err);\n      return;\n    }\n    setMessage(\"\");\n  }\n\n  switch (username) {\n    case \"\":\n      if (userBtcAddress === \"\") {\n        return <div className=\"Chat\">Please connect your wallet!</div>;\n      }\n      return (\n        <div className=\"Chat\">\n          <p>Please create a Username</p>\n          <form>\n            <input\n              className=\"chatInput\"\n              onChange={(e) => handleInputChange(e)}\n              placeholder=\"Be Kind.\"\n              type=\"text\"\n              value={message}\n            />\n            <button\n              className=\"sendButton\"\n              type=\"submit\"\n              onClick={(e) => sendMessage(e)}\n            >\n              Send\n            </button>\n          </form>\n        </div>\n      );\n    default:\n      return (\n        <div className=\"Chat\">\n          <div className=\"chatLog\">\n            {chatLog\n              .slice(0)\n              .reverse()\n              .map((item, index) => {\n                return (\n                  <div className=\"messageText\" key={index}>\n                    {item}\n                  </div>\n                );\n              })}\n          </div>\n          <form>\n            <input\n              className=\"chatInput\"\n              onChange={(e) => handleInputChange(e)}\n              placeholder=\"Be Kind.\"\n              type=\"text\"\n              value={message}\n            />\n            <button\n              className=\"sendButton\"\n              type=\"submit\"\n              onClick={(e) => sendMessage(e)}\n            >\n              Send\n            </button>\n          </form>\n        </div>\n      );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}